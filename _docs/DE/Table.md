---
title: Data Engineer
tags: 
 - CS
 - BigData
 - Data Engineer
 - Master Table
 - Transaction Table
 - History Table
description: Data Engineer
permalink: /docs/DE/table
---

# Master Table & Transaction Table

- 데이터베이스 시스템에는 Master와 Transaction 두 가지 유형의 테이블이 있습니다.
- 데이터 웨어하우스 혹은 데이터 레이크 구축시, 원천테이블의 종류와  특성을 파악하고 설계하는 것이 중요합니다.
- 데이터베이스 개발 중에 Master Table과 Transaction Table을 식별하여 어떻게 상호작용이 일어나는지 이해하는 것 또한 중요합니다. 

<center><img src="https://metamug.com/article/images/differ-master-vs-transaction-table.svg"></center>


## Master Table

- 기준이 되는 테이블
- 마스터 테이블은 DB를 설계할 때 가장 우선적으로 설계됩니다 
- 마스터 테이블은 시스템의 기본이 되는 테이블이기 때문에 마스터 테이블의 열과 제약조건은 시스템의 Entity를 나타냅니다.
- ex) 고객마스터, 계정마스터..

또한 마스터 테이블은 가장 최신의 상태를 유지하고 변경이 있을때마다 마스터 테이블의 정보를 저장하는 History Table(이력 테이블)이 존재합니다.(가변속성들을 관리 위함)

## Transaction Table

트랜잭션은 시스템 내 Entity(마스터 테이블)에 의해 수행되는 활동입니다.
이러한 활동은 트랜잭션 테이블에 저장되며 일반적으로 트랜잭션 테이블에는 마스터 테이블에 대한 외래 키가 있습니다.

- 주문, 서비스이용내역.. etc 
- CREATE OR DELETE, UPDATE는 없음

원칙적으로 트랜잭션 테이블은 등록만 가능한 테이블입니다. 즉, 레코드를 등록 또는 삭제만 가능하기 때문에, History Table은 존재하지 않습니다.


## 식별 기준

|기준|Master|Transaction|
|:---:|:-------:|:----------:|
|데이터|변경될 가능성이 적은 데이터|자주 변경되는 데이터|
|정보|Master Data: 사용자, 고객|Transaction Data: 주문, 출석, 판매|
|타임스탬프| 없을 가능성이 큼|모든 트랜잭션은 일반적으로 타임스탬프와 연관이 있습니다|
|파티션|정규화를 위한 수직|타임스탬프/날짜를 기반으로 수평분할|
|Use| 시스템 정보 저장|시스템 이벤트 저장|


1) 구성형태

이력 테이블은 원장성 테이블(master table)의 변경된 상태 속성 정보를 보관하는 역할을 합니다. 원장성 테이블의 외부에 동일한 구조를 가지고 있는 외부 이력 테이블(Outer History Table) 형태가 있을 수 있고 원장성 테이블의 내부에 상위키(upper key) 속성칼럼을 포함시켜 내부순환(recursive) 구조를 가진 내부 이력 테이블(Inner History Table) 형태가 있을 수 있으며, 원장성 테이브르이 중요 상태정보만을 이력관리하는 중요항목 이력 테이블(Hot-Item History Table) 구조로 구성될 수 있습니다.



2) 데이터 성격

변경된 상태정보를 시작시점~종료시점의 구간으로 하는 선분이력(Line History) 형태로 관리될 수도 있고 변경시점을 기준으로 하는 점 이력(Point History) 형태로 이력은 관리될 수 있습니다. 선분 이력 테이블(Line History Table)은 주로 원장성 테이블에 구축되며 점이력 테이블(Point History Table)은 주로 양면성 테이블에 일반적으로 구축됩니다.



이상으로 짧게나마 테이블의 종류와 특성을 알아보았습니다. 원천 테이블의 종류와 특성을 정확히 파악하는 것은 시계열(time serial)로 구축될 대상이 무엇인지, 시계열 간격(일, 월, 년)은 어떻게 할것인지 또한 이력 테이블의 구축이 필요한 대상이 무엇인지, 스냅샷(snapshot history)이력으로 할것인지, 선분이력(Line History) 또는 점이력(Point History)로 구축할 것인지 결정하는 것이 아주 중요한 작업입니다.



원칙적으로 원장성 테이블일 경우 시계열로 구축이 될 것이고 아울러 기간계의 이력테이블이 없거나 부실하다면 DW시스템에 새로 이력테이블을 구축해야 할 것입니다. 또한 원장성 테이블의 특성에 따라서 스냅샷 이력 테이블로 구축할지 선분이력 테이블로 구축할지도 고려되어야 합니다.



거래성 테이블은 DW 구축시 그냥 1:1로 가져온다고 생각하시면 될 것 같습니다. 양면성 테이블은 해당 프로젝트 사이트 업무 환경에 따라 그 설계방식이 차이가 발생할 수 있습니다. 시계열로 구축이 필요한지 아닌지 여러 각도로 살펴보아야 합니다. 왜냐하면 거래성 테이블 성격도 가지고 있기 때문에 데이터 크기가 상당히 큰 경우가 대부분입니다. 따라서 효율적으로 설계하지 못하면 ETL시 많은 부하와 적재시간이 소요됩니다. 양면성 테이블의 경우 이력이 필요할 경우 주로 점이력 테이블을 구축하게 됩니다.

